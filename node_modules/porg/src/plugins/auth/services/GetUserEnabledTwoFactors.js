export default async ({ username, getUserU2F, getUserTOTP }) => {
  const enabledTwoFactors = []
  const u2f = await getUserU2F({ username })
  if (u2f && u2f.keyHandle) {
    enabledTwoFactors.push('u2f')
  }
  const totp = await getUserTOTP({ username })
  if (totp && totp.secret && totp.confirmed) {
    enabledTwoFactors.push(['totp'])
  }
  return enabledTwoFactors
}
