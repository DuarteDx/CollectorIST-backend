import Joi from 'joi'

const handler = ({persistentTaskProvider}) => {
  return async (request, h) => {
    const task = await persistentTaskProvider.getTaskInstanceById({id: request.params.id})
    return task
  }
}

const config = ({roles, twoFactor}) => {
  return {
    description: 'Get task instance by id',
    validate: {
      params: {
        id: Joi.string().required()
      }
    },
    plugins: {
      'porg-auth': {
        type: 'user-session',
        twoFactor,
        roles
      }
    }
  }
}

export default { handler, config }
