import mysql from 'mysql'
import { logger } from 'papagaio'

let pool = null

const configDriver = ({ options }) => {
  pool = mysql.createPool({
    connectionLimit: options.connectionLimit,
    host: options.host,
    user: options.user,
    password: options.pass,
    database: options.database
  })
}

const shutdown = () => {
  logger(['info', 'database', 'mysql'], 'MySQL Pool is shutting down...')
  pool.end(() => {
    logger(['info', 'database', 'mysql'], 'MySQL Pool successfully terminated!')
  })
}

const cleanDatabase = async () => {
  throw new Error('Clean database not defined')
}

export {
  configDriver,
  pool,
  shutdown,
  cleanDatabase
}
