const users = {
  'ist167033': {
    username: 'ist167033',
    roles: ['admin'],
    auth: {}
  }
}

export default class RawUserAuthProvider {
  async getU2FForUsername ({username}) {
    return users[username].auth.u2f
  }

  async createOrUpdateAuthorU2FAuth ({username, u2f}) {
    users[username].auth.u2f.publicKey = u2f.publicKey
    users[username].auth.u2f.keyHandle = u2f.keyHandle
    users[username].auth.u2f.certificate = u2f.certificate
  }

  async createOrUpdateAuthorU2FAuthRequest ({username, u2f}) {
    users[username].auth.u2f.authRequest = u2f.authRequest
  }

  async registerTOTPSecretForUsername ({username, secret}) {
    users[username].auth.totp.secret = secret
  }

  async confirmTOTPSecretForUsername ({username}) {
    users[username].auth.totp.confirmed = Date.now()
  }

  async getTOTPForUsername ({username}) {
    return users[username].auth ? users[username].auth.totp : null
  }
}
